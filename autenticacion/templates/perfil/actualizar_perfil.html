{% extends "natureweb/base.html" %}
{% load crispy_forms_tags %}

{% block content %}
<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-md-10 col-lg-8">

            <!-- Mensajes de confirmaciÃ³n -->
            {% if messages %}
                {% for message in messages %}
                    <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
                        {{ message }}
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Cerrar"></button>
                    </div>
                {% endfor %}
            {% endif %}

            <div class="card shadow-lg p-4 mb-4">
                <h2 class="text-center mb-4">ğŸ‘¤ Mi Perfil</h2>

                {% if user.perfilusuario.imagen %}
                    <div class="text-center mb-4">
                        <img src="{{ user.perfilusuario.imagen.url }}" alt="Avatar" class="img-thumbnail rounded-circle" width="130">
                    </div>
                {% endif %}

                <p><strong>ğŸ‘¤ Nombre:</strong> {{ user.first_name }} {{ user.last_name }}</p>
                <p><strong>ğŸ“§ Correo:</strong> {{ user.email }}</p>
                <p><strong>ğŸ”– Tipo de usuario:</strong> {{ user.perfilusuario.tipo_usuario.nombre }}</p>
                <p><strong>ğŸ“† AÃ±os de experiencia:</strong> {{ user.perfilusuario.anios_experiencia|default:"Sin especificar" }}</p>
                <p><strong>ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ PÃºblico atendido:</strong> {{ user.perfilusuario.adultos_ninos|default:"Sin especificar" }}</p>

                {% if user.perfilusuario.tipo_usuario.nombre != "Cliente" %}
                    <p><strong>ğŸ©º Especialidades:</strong>
                        {% for especialidad in user.perfilusuario.especialidades.all %}
                            <span class="badge bg-secondary">{{ especialidad.nombre }}</span>
                        {% empty %}
                            <span class="text-muted">No ha seleccionado especialidades aÃºn.</span>
                        {% endfor %}
                    </p>

                    <hr>

                    <p><strong>ğŸ¥ Nombre del lugar 1:</strong> {{ user.perfilusuario.nom_lugar|default:"No especificado" }}</p>
                    <p><strong>ğŸ“ DirecciÃ³n del lugar 1:</strong> {{ user.perfilusuario.direccion|default:"No especificada" }}</p>
                    <p><strong>ğŸ“Œ UbicaciÃ³n mapa 1:</strong> {{ user.perfilusuario.ubicacion|default:"No especificada" }}</p>

                    <p><strong>ğŸ¥ Nombre del lugar 2:</strong> {{ user.perfilusuario.nom_lugar2|default:"No especificado" }}</p>
                    <p><strong>ğŸ“ DirecciÃ³n del lugar 2:</strong> {{ user.perfilusuario.direccion2|default:"No especificada" }}</p>
                    <p><strong>ğŸ“Œ UbicaciÃ³n mapa 2:</strong> {{ user.perfilusuario.ubicacion2|default:"No especificada" }}</p>

                    <p><strong>ğŸ“ Contacto 1:</strong> {{ user.perfilusuario.contacto1|default:"No disponible" }}</p>
                    <p><strong>ğŸ“ Contacto 2:</strong> {{ user.perfilusuario.contacto2|default:"No disponible" }}</p>

                    <p><strong>ğŸ“ DescripciÃ³n:</strong><br> {{ user.perfilusuario.descripcion|default:"No disponible" }}</p>
                {% endif %}
            </div>

           <div class="card shadow-lg p-4">
              <h3 class="text-center mb-3">âœï¸ Editar Perfil</h3>

              <p class="text-muted mb-2">
                ğŸ“Œ Para los campos de "UbicaciÃ³n en el mapa", puedes copiar las coordenadas desde Google Maps. Ejemplo: <code>-3.999145, -79.204201</code>
              </p>

              <form method="post" enctype="multipart/form-data">
                {% csrf_token %}
                {{ perfil_form|crispy }}

                <div class="text-center mt-3">
                  <button type="submit" class="btn btn-success px-4">Guardar cambios</button>
                </div>
              </form>
            </div>

        </div>
    </div>
</div>
{% endblock %}
